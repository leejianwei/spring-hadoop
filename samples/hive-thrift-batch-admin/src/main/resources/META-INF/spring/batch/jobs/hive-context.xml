<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:batch="http://www.springframework.org/schema/batch"
	xmlns:hdp="http://www.springframework.org/schema/hadoop"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:c="http://www.springframework.org/schema/c"
	xmlns:p="http://www.springframework.org/schema/p"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
      	http://www.springframework.org/schema/batch	http://www.springframework.org/schema/batch/spring-batch-2.1.xsd
      	http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
      	http://www.springframework.org/schema/hadoop http://www.springframework.org/schema/hadoop/spring-hadoop.xsd">

	<context:property-placeholder location="classpath:hadoop.properties"
		ignore-resource-not-found="true" ignore-unresolvable="true" />


	<hdp:configuration>
		<!-- The value after the question mark is the default value if another 
			value for hd.fs is not provided -->
		fs.default.name=${hd.fs:hdfs://localhost:9000}
	</hdp:configuration>


	<hdp:hive-client host="localhost" port="10000">
	</hdp:hive-client>
	
	
	<job id="hiveJob" xmlns="http://www.springframework.org/schema/batch">
		<step id="init" next="loadData">
			<tasklet ref="initTableTasklet" />
		</step>
		<step id="loadData">
			<tasklet ref="loadDataScriptTasklet" />
		</step>
		<!-- 
		<step id="cleanData">
			<tasklet ref="cleanDataTasklet" />
		</step>
		 -->
	</job>

	<bean id="initTableTasklet" class="org.springframework.data.hadoop.hive.HiveTasklet"
		p:hive-client-ref="hive-client">
		<property name="scripts">
			<list>
				<value>org/springframework/data/hadoop/hive/script.sql</value>
			</list>
		</property>
	</bean>


	<hdp:hive-tasklet id="loadDataScriptTasklet" hive-client-ref="hive-client">
		<hdp:script>			
			LOAD DATA LOCAL INPATH 'data.txt' OVERWRITE INTO TABLE t1;
		</hdp:script>
	</hdp:hive-tasklet>
	
	<hdp:hive-tasklet id="cleanDataTasklet" hive-client-ref="hive-client">
		<hdp:script>			
			drop table t1;
		</hdp:script>
	</hdp:hive-tasklet>

</beans>
